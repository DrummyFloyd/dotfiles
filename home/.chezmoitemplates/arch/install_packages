{{- /*
  vim:ft=bash.gotmpl:
*/ -}}
PACKAGES={{ .archPackages | join " " }}
OUTPUT=$(yay -Q {{ .packages | join " " }} 2>&1)

MISSING_PACKAGES=$(echo "$OUTPUT" | grep "error: package" | sed -e "s/error: package '\(.*\)' was not found/\1/" | tr '\n' ' ' | sed 's/ $//')

if [[ -n "$MISSING_PACKAGES" ]]; then
  log_task "Installing packages: $MISSING_PACKAGES"
  yay -Syu $MISSING_PACKAGES
fi
